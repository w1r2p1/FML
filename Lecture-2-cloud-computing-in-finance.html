<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Algorithmic trading and investment</title>
    <meta charset="utf-8" />
    <meta name="author" content="Barry Quinn" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/xaringanExtra-webcam/webcam.js"></script>
    <script id="xaringanExtra-webcam-options" type="application/json">{"width":"200","height":"200","margin":"1em"}</script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <link href="libs/vis/vis.min.css" rel="stylesheet" />
    <script src="libs/vis/vis.min.js"></script>
    <link href="libs/timeline/timevis.css" rel="stylesheet" />
    <script src="libs/timevis-binding/timevis.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap/js/bootstrap.min.js"></script>
    <script src="libs/bootstrap/shim/html5shiv.min.js"></script>
    <script src="libs/bootstrap/shim/respond.min.js"></script>
    <script src="libs/viz/viz.js"></script>
    <link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding/grViz.js"></script>
    <link rel="stylesheet" href="css/sfah.css" type="text/css" />
    <link rel="stylesheet" href="css/fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




layout: true
  
&lt;div class="my-footer"&gt;&lt;span&gt;quinference.com&lt;/span&gt;&lt;/div&gt;

<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(img/redlogo.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>



---
name: ATL-title
class: inverse,left, middle
background-image: url(img/markus-spiske-466ENaLuhLY-unsplash.png)
background-size: cover

# Algorithmic Trading and Investing (FIN7030)


# .fancy[Lecture 2: High performance cloud computing in finance]

.large[Barry Quinn PhD CStat | Queen's Management School | 2021-01-12]

&lt;!-- this ends up being the title slide since seal = FALSE--&gt;

---
class:inverse
# Outline 

- .salt[What is cloud computing?]
- .fat[Your Turn: Introduction to the QMS_HPCC]
- .salt[Taxonomy of parallel computing]
- .fat[Your turn: parallelising in R]
- .salt[Financial applications in the cloud]
- .salt[Economics of the cloud computing]
- .salt[Some case studies]
---
class: middle
# What is cloud computing ?
- .heat[Cloud computing shares many of the similarities of electricity]

.center.large[In the early days of electrical power, corporations and factories where powered by on-site small-scale power plants. Today, large scale power plants with efficient transmission networks have powered modern industrial society, allowing electricity to be at everyone's disposal ar reasonable prices]

- .heat[Much like electricity the core concept of cloud computing is resource sharing]
---
class: top
# What is cloud computing ?

.fat[definitions:]

&gt;A model for enabling ubiquitious, convenient, on-demand network access to a shared pool of configurable computing resources (e.g., networks, servers, storage, applications, and services) that can be rapidly provisioned and released with minimal management effort or server provider interaction

&lt;footer&gt;National Institute of Standards and Technology(NIST) of the US Department of Commerce, 2019&lt;/footer&gt;

&gt;Simply put, cloud computing is the delivery of computing services – including servers, storage, databases, networking, software, analytics and intelligence – over the Internet (**"the cloud"**) to offer faster innovation, flexible resources and economies of scale. Typically, you only pay for cloud services you use, helping you lower your operating costs, run your infrastructure more efficiently and scale as your business needs change.

&lt;footer&gt;Beginners guide to cloud computing, Microsoft Azure, 2020&lt;/footer&gt;

---
class:top
## Essential characteristics of cloud computing solutions
.heatinline[The follow distinguish cloud computing from other solutions, such as on-site high performance computing servers]

- .large.fancy[On-demand self-service] 
  - A consumer can provision computing capacity as needed without interaction with service provider.
- .large.fancy[Broad network access]
  - Computing resources are available to the consumer through the network and can  be accessed fro mobile phones, tablets, laptops, and workstations.
- .large.fancy[Resource pooling]
  - Resources are dynamically assigned to customers' needs.
- .large.fancy[Rapid elasticity]
  - Capacities can be reconfigured automatically to scale rapidly in response to the changing demand.
- .large.fancy[Measured service]
  - The resource utilisation is automatically controlled and optimised by the cloud systems.  The usage is monitored, measured, and reported.

---
class: middle
## Why high performance computing and why now?
.salt[Regulatory response to the flash crash of 2010]
&gt; On the 6th May, 2010 at 2.45 p.m.(EST), the US stock market experienced a nearly 10% drop in the Dow Jones Industrial Average, only to recover most of ther loss a few minutes later

.saltinline[It took the regulatory agencies (SEC) five months to come up with an investigation report on this crash]

.heatinline[In the congressional hearings after the event, the SEC official give the primary reason for the long delay as the volumne of data to be investigated (~20 terabytes)]

.heatinline[HPC scientific computing systems such as the National Research Scientific Computing center(NERSC). routinely work with hundreds of terrabytes in minutes]

.heatinline[After the congressional hearing Lawrence Berkley National Laboratory (LNBL) established the Computational Intelligence and Forecasting Technologies (CIFT) project to promote HPC tools and techniques for analysing of financial times series data]
---
class:top
.large.center[Evolution of financial problem complexity and cloud computing]

<style>.vis-timeline { 
border-color: #269026;
  background-color: lightblue;
  font-size: 12px;}
.vis-item {
  border: 2px solid #5ace5a;
  font-size: 10pt;
  background: #d9ffd9;
  font-family: lucinda console;
  padding: 2px;}</style>
<div id="htmlwidget-5ccf4979616f8716bd6f" class="timevis html-widget" style="width:960px;height:500px;">
<div class="btn-group zoom-menu">
<button type="button" class="btn btn-default btn-lg zoom-in" title="Zoom in">+</button>
<button type="button" class="btn btn-default btn-lg zoom-out" title="Zoom out">-</button>
</div>
</div>
<script type="application/json" data-for="htmlwidget-5ccf4979616f8716bd6f">{"x":{"items":[{"start":"1973","content":"Black-Scholes-Merton<br>options pricing model","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"1993","content":"Stochastic modelling<br>of volatility","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"2000","content":"Jump diffusion models","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"2010","content":"Flash Crash","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"2013","content":"Basel III","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"2018","content":"Rebentrost et al.2018<br> propose a quantum computational<br> algo to price derivatives","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"2019","content":"CME Smart Stream launched:<br> First derivatives exchange<br>to offer real-time cloud-based market data","group":"1","style":"font-size: 0.5em; color: blue;"},{"start":"1961","content":"Late Professor JohnMcCarthy (MIT) suggested<br>computing would be sold as a utility","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"1967","content":"IBM virtualised <br> operating systems","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"1969","content":"APRANET <br> launched","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"1988","content":"Nearly 100,000 computers connected to the internet","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"1991","content":"World Wide Web launched; 1 million<br>computers connected to the Internet","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"1996","content":"Compaq Computer Corp.introduce an<br>'An Internet Divisions Strategy for Cloud Computing'","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2002","content":"Amazon Web Services (AWS) launch public Cloud","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2005","content":"OpenNebula research project launched; 'Big data'starts to become popular","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2006","content":"Amazon launch Elastic Compute Cloud (EC2)","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2007","content":"Dropbox founded; Cloud storage becomes a service","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2010","content":"Microsoft launch Azure","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2012","content":"DigitalOcean launched; third largest cloud computing company (2020)","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2013","content":"Real-time streaming data processed on AWS","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2015","content":"Machine learning services on the Cloud","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2018","content":"Microsoft launches under the sea data-centre","group":"2","style":"font-size: 0.5em; color: red;"},{"start":"2019","content":"Google Tensor Processing Units (TPUs) avaliable on the Cloud","group":"2","style":"font-size: 0.5em; color: red;"}],"groups":[{"id":"1","content":"Finance<Br> Computational<br>Milestones"},{"id":"2","content":"Cloud<br>Computing<br>Milestones"}],"showZoom":true,"zoomFactor":0.5,"fit":true,"options":[],"height":null,"timezone":null,"api":[]},"evals":[],"jsHooks":[]}</script>
---

---
class: middle
## QMS High-Performance Cloud Computing
- In this course we will be using a cloud-based Linux machine running [RStudio Server Pro](https://rstudio.com/products/rstudio-server-pro/)
&gt;Rstudio Server Pro us the preferred data analysis and integrated development experience for professional R users and data science teams who use R and Python. &lt;footer&gt;RStudio Team, 2020&lt;/footer&gt;

- This machine is hosted on Microsoft Azure running a Linux (ubuntu 18.04) operating system with 64 vCPUs and 256 GiB of RAM.
- Student accounts will have approximately 1 vCPU and 4 GiB RAM.
- This state-of-the-art student resource will allow you to integrate R and Python to produce agile analyitical solutions for assessment and beyond.

---
class:top,center
# Accessing the server

.pull-left[ 
### Steps
1. Open a web browser
2. Navigate to: http://qms.uksouth.cloudapp.azure.com:8787/
3. login using the credential provided
]
.pull-right[ 
&lt;img src="img/qms_rstudio_login.png" alt="server_login" /&gt;

]
---
class:middle
# Taxonomy of parallel computing
- Computer processors process instructions sequentially.
- Traditional computing problems are serial by design.
- The birth of multiprocessors (*multicore processors*) has innovated a new type of computing problem:

.acid.center[how to utilise the parallel structure]
- Roughly speaking, multicore processors are equivalent to running multiple computers at a time
---
class:middle
# Taxonomy of parallel computing
.pull-left.acid[Parallel computing problems in contrast to serial computing problems, refer to the type of problem that can be divided into small Jobs which can be processed simultaneously ]
.pull-right[
**embarrassingly parallel computing**:
<div id="htmlwidget-3c5ebe92c6ec116b5ae2" style="width:504px;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c5ebe92c6ec116b5ae2">{"x":{"diagram":"\ndigraph rmarkdown {\n\"Input Data\"->{Job1,Job2,Job3}\n{Job1,Job2,Job3}->\"Results\"\n} \n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>

**nonembarrassingly parallel computing**:
<div id="htmlwidget-895c4ed0233df7d52de8" style="width:504px;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-895c4ed0233df7d52de8">{"x":{"diagram":"\ndigraph rmarkdown {\n\"Input Data\"->{Job1,Job2,Job3}\n{Job1,Job2,Job3}->\"Results\"\nJob1->Job2[dir=\"both\",label=\"Information\",style=\"dashed\"]\nJob2->Job3[dir=\"both\",label=\"Information\",style=\"dashed\"]\n{rank=same; Job1;Job2;Job3}\n} \n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
]
---
class:top

# Taxonomy of parallel computing

.pull-left[

#### Figure 1: embarrassingly parallel computing
<div id="htmlwidget-ee4597a14ad166730806" style="width:504px;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ee4597a14ad166730806">{"x":{"diagram":"\ndigraph rmarkdown {\n\"Input Data\"->{Job1,Job2,Job3}\n{Job1,Job2,Job3}->\"Results\"\n} \n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>

#### Figure 2: snonembarrassingly parallel computing
<div id="htmlwidget-0ba7063067021a309455" style="width:504px;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-0ba7063067021a309455">{"x":{"diagram":"\ndigraph rmarkdown {\n\"Input Data\"->{Job1,Job2,Job3}\n{Job1,Job2,Job3}->\"Results\"\nJob1->Job2[dir=\"both\",label=\"Information\",style=\"dashed\"]\nJob2->Job3[dir=\"both\",label=\"Information\",style=\"dashed\"]\n{rank=same; Job1;Job2;Job3}\n} \n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
]
.pull-right[
-  Based on the dependence structure of sub-Jobs problems parallel computing problems can be further classified into *embarrassingly parallel* and  *non embarrassingly parallel*
- If sub-Jobs are independent then we have an *embarrassingly parallel* problem
- Otherwise we have a  *non embarrassingly parallel* problem
- In figure 1 there is no communication between Jobs, while in figure 2 some communication between Jobs is required
]
---
# Taxonomy of parallel computing
class:middle
- Problems can also be classified by there nature
- Data parallelism focuses on distributing data across different processors
- Job parallelism focuses on distributing execution processes (subtasks) to different processors
---
class:middle,left
# The serial-parallel scale
.left-column[
<div id="htmlwidget-05135ff7e40dc9e3cbba" style="width:504px;height:400px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-05135ff7e40dc9e3cbba">{"x":{"diagram":"\ndigraph  {\ngraph [label=\"Figure 1: Inherently serial\"]\n\"Input Data\"->Job1->\"Results\"->Job2->\"More Results\"->Job3\n} \n","config":{"engine":"dot","options":"margin: auto !important;"}},"evals":[],"jsHooks":[]}</script>
]

.right-column[

- Another important aspect of parallel computing is whether the parallel computing problem is *scaleable*.
- An inherently serial problem cannot be parallelised, e.g. Figure 1
- Scalable problems have either a scalable problem size or scalable parallelism.
- Either the solution time reduces with the increasing of parallelism or the performance of the solution increases with the problem size.
- The elasticity of the computing architecture is the key to the success of the processing of scalable problems

]

.footnote.saltinline[*Elastic computing*: Elastic computing is a computing service which has the ability to scale resources to meet requirements, e.g. Amazon's EC2 instances]

---
class:middle
# Example from the finance industry
####.heat[Monte Carlo (MC) Options Pricing]
- Using arbitrage pricing theory, the option price is equal to the expected payoff `\(V\)` discounted by a factor `\(D\)` which can be evaluated via MC method.
The Monte Carlo estimator of option price is given by
`$$C_0=D \times \frac{1}{N} \sum_{\omega \in sampleset}V(\omega)$$`
where N is the number of sample paths (simulations)

1. The simulation of each price path is independent of other paths, therefore it is easy to parallel process the simulation of different paths on different computing nodes
2. It is a task-parallel in the sense that simulations of each path is a small task.  However it is not data-parallel since there is no data set to be distributed to different computing nodes.
3. The scalable benefit is improved price accuracy as `\(N\)` increases, the error reduction being approximately `\(1/\sqrt{N}\)`

---
class:middle
# Example from the finance industry
#####.heat[Backtesting Investment Strategies]

.pull-left[
#### Task-parallel backtesting
- Suppose you need to backtest a basket of different investment strategies to identify the optimal strategies
- The process of each investment strategy is independent of each other and can be run simultaneously.
- Distributing the processing of different strategies to different computing nodes is an *embarrassingly parallel* and *task parallel* implementation.
]
.pull-right[
#### Data-parallel backtesting
- Backtesting on one strategy can also be implemented as *data parallel*
- By generating subsamples from test data set(e.g. by bootstrapping), strategy can be processed on different subsamples simultaneously
- The results on different subsamples is then aggregated to generate the performance and risk report of the strategy
]
---
class:middle
# Integrating Python and R
---
class:top
# Parallelising in RStudio
.pull-left[

```python
def gen_paths(S0, r, sigma, T, M, I):
    dt = float(T) / M
    paths = np.zeros((M + 1, I), np.float64)
    paths[0] = S0
    for t in range(1, M + 1):
        rand = np.random.standard_normal(I)
        paths[t] = paths[t - 1] * np.exp((r - 0.5 * sigma ** 2) * dt +
                                         sigma * np.sqrt(dt) * rand)
    return paths
```
]
.pull-right[
- The code implements
]
---
class:top,center
#Financial application in cloud computing
---
class:top,center
# Economics of cloud computing
---
class:middle
# Terminology
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
